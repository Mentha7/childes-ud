\chapter{CHILDES \emph{CHAT} and UD \emph{CoNLL-U}}
\label{Chapter2}

This chapter introduces the two annotation schemes of interest---\emph{CHAT} and \emph{CoNLL-U}---in detail and gives the reader an idea of what information is shared by both annotations and what information is exclusively relevant to only one of them. This will shed light on the implementation of \emph{chatconllu} which will be discussed in \Cref{Chapter3}.

\section{CHILDES CHAT Transcription System}

\subsection{Motivation}
The \emph{Codes for Human Analysis of Transcripts} (CHAT) transcription system is developed for the \emph{Child Language Data Exchange System} (CHILDES) project (\cite{Macwhinney2000}) to aid child language acquisition research.

As MacWhinney pointed out in the CHAT manual, collecting audio data for spontaneous conversational interactions is easy, one just have to turn on the recorder, however, processing the collected recordings and turning them into usable data for linguistic research is a demanding task (\cite{Macwhinney2000}).

For studies that rely on speech corpora, transcribing the conversations is an indispensable preprocessing step. Consistency treatment of raw data is critical to scientific research. Therefore, it is hard to imagine how difficult it was to maintain transcription standards when there was no standard format, especially for child speech, which is usually more chaotic than average adult speech data. Thus CHAT is designed to accommodate the need for a standard transcription system of conversational speech. Moreover, CHAT transcripts can be analysed by TalkBank programs \sidenote{\url{https://talkbank.org/software/}} like \emph{Computerized Language Analysis} (commonly referred to as the CLAN Program), which facilitates the transcription, sharing and analysis of human conversational interactions.

\subsection{File Structure}
For a CHAT file to be well-formed, there are some basic structural requirements to comply with. The minimum standards are prescribed by \emph{minCHAT} (\cite{Macwhinney2000}).

% describe only relevant minCHAT structure
First of all, each CHAT file should have at least two parts:
\begin{itemize}
	\item \emph{headers} preceded by the \texttt{@} symbol that stores metadata like language and participants. Some headers are obligatory \sidenote{Obligatory headers include: the file-initial header @Begin, @Languages, @Participants, @ID and the file-final header @End.}, some are optional.\\
	Despite its name, headers can be added in the middle of a CHAT file to represent information like tape locations. It is likely that \emph{header} is a misnomer, and they should be called \emph{meta} as they preserve in general higher-level information.
	\item the \emph{main line}---utterances led by the asterisk symbol \texttt{*} which are the actual sentences being said.\\
\end{itemize}

Then, additional information can be \emph{optionally} added as dependent tiers. Annotations of morphological, syntactical, and phonological information or general remarks of the transcriber's choice all go into separate dependent tiers of the main utterance. Dependent tiers are preceded by the percent symbol \texttt{\%}.

% describe mor and gra tiers
\subsection{Dependent Tiers}
The inclusiveness and extensibility of the CHAT format is demonstrated by the use of dependent tiers, since almost any type of information can be organised into separate dependent tiers and added to the relevant utterances. The CHAT manual defines a standard list of dependent tiers. The tier names are mostly 3-lowercase-letter codes, but with the exceptions of tier names preceded by an \texttt{x}, like \texttt{\%xmor}. With the active use of dependent tiers, researchers can adjust the level of details to meet their individual needs in the CHAT files. At the same time, they do not interfere with the other obligatory parts of the file.

A dependent tier can contain one of the two types of information:
\begin{itemize}
	\item utterance-level information
	\item word-level information
\end{itemize}

\paragraph{utterance-level information}
Utterance-level information usually appear as a descriptive sentence. For example, the action tier that describe actions by the speakers \texttt{\%act}. It can also be in other forms, like the addressee tier which uses three-letter participant codes.\\

\lstset{
numbers = none,
frame = single,
}

\begin{lstlisting}[caption={Excerpt from Adam/040217.cha of the Brown Corpus (\cite{brown1973})}, label={lst:chatsent1}]
*PAU:	0 .
%act:	hits Adam
\end{lstlisting}

Listing \ref{lst:chatsent1} is an example of an utterance with dependent tiers.\\


\paragraph{word-level information}
Word-level information are associated with words in the utterance. Pieces of word-based information string are separated by the space character.\\

\lstset{
numbers = none,
frame = single,
}

\begin{lstlisting}[caption={Excerpt from Adam/040217.cha of the Brown Corpus (\cite{brown1973})}, label={lst:chatsent2}]
*MOT:	what happened ?
%mor:	pro:int|what v|happen-PAST ?
%gra:	1|2|SUBJ 2|0|ROOT 3|2|PUNCT
\end{lstlisting}

Listing \ref{lst:chatsent2} is an example of an utterance with dependent tiers.\\

\paragraph{common tiers}
The two most commonly seen tiers are \texttt{\%mor} and \texttt{\%gra} which can be generated automatically by the use of a series of CLAN programs---MOR, POST, POSTMORTEM and GRASP.

The \texttt{\%mor} tier encodes morpgological information including the affixes, stem and part-of-speech tags of words, while the \texttt{\%gra} tier keeps the dependency structure of the utterance and the grammatical relations between head and dependent words.

Since morphosyntactic information in \texttt{\%mor} and \texttt{\%gra} should be kept with individual tokens in CoNLL-U files, they have to be processed in such a way that all relevant information from both tiers (if present) are associated with the respective token in the utterance.\\

\begin{lstlisting}[caption={Excerpt from Adam/040217.cha of the Brown Corpus (\cite{brown1973})}, label={lst:chatsent3}]
*CHI:	dat's [: that's] hard .
%mor:	pro:dem|that~cop|be&3S adv|hard .
%gra:	1|2|SUBJ 2|0|ROOT 3|2|JCT 4|2|PUNCT
\end{lstlisting}

Listing \ref{lst:chatsent3} is an example of an utterance with dependent tiers.\\

% \subsubsection{Morphosyntactic Coding with \emph{\%mor} Tier}
% % token links %mor to the main line. one-to-one correspondence between
% % normalised utterance and %mor.
% % structure of individual words
% % structure of word groups  -> conllu: multi-word tokens

% \subsubsection{Syntactic Dependency Analysis with \emph{\%gra} Tier}
\newcommand{\conllu}[1]{&\footnotesize\texttt{#1}}
\newcommand{\tab}{&\hspace{0.1em}}
\setlength{\abovedisplayskip}{3pt}
\setlength{\belowdisplayskip}{3pt}

\section{UD \emph{CoNLL-U} Annotation Scheme}

The CoNLL-U format is modified from the CoNLL-X format introduced by (\cite{buchholz-marsi-2006-conll}).

A file in the CoNLL-U format can be seen as a collection of sentences, where each sentence is followed by an empty line. The empty lines serve as sentence boundaries.

Each CoNLL-U sentence can be divided into two parts:
\begin{itemize}
	\item comment lines \sidenote{Meta-information about the entire document are stored in the comment lines of the first sentence.} starting with the hash symbol \texttt{\#} with obligatory \texttt{sent\_id} \texttt{text}, corresponding to a unique index in the conllu file and the text of the sentence. A minimal example is shown below:
	\begin{flalign*}
	\conllu{\# sent\_id = 1}&\\
	\conllu{\# text = why ?}&
	\end{flalign*}
	\item token lines where each line represent a token in the sentence.
\end{itemize}
\paragraph{token representation} \sidenote{For more information visit: \url{https://universaldependencies.org/format.html}}
Each token in the text should possess one line, and each line is single-tab-separated into 10 fields:
\begin{enumerate}
	\item \texttt{ID:} word index starting from 1 for each new sentence \sidenote{With the exception of empty nodes, which can be a decimal number greater than 0.}.
	\item \texttt{FORM:} word form or punctuations as indicated in the sentence comment.
	\item \texttt{LEMMA:} lemma or dictionary form of the word
	\item \texttt{UPOS:} one of the 17 Universal part-of-speech tags \sidenote{The UPOS tags are listed in \Cref{tab:uposset} in \Cref{appendixa}}.
	\item \texttt{XPOS:} language-specific POS tags
	\item \texttt{FEATS:} list of morphological features \sidenote{They have to be from UD's universal feature inventory or from a predefined language-specific set accepted by UD. } separated by \texttt{|}.
	\item \texttt{HEAD:} index of the head word of the current token, or \textlf{0} if the current token is the root.
	\item \texttt{DEPREL:} one of the 37 universal syntactic relations in UD \sidenote{\url{https://universaldependencies.org/u/dep/index.html}}, or one of its subtypes.
	\item \texttt{DEPS:} head-deprel pair in the form of \texttt{head:deprel}.
	\item \texttt{MISC:} any other information related to the current token.
\end{enumerate}
\paragraph{additional constraints} The fields cannot be empty, if any information \sidenote{with the exception of word index} is not specified for a field, an underscore placeholder \texttt{\_} is used in place.
The tokens in the previous minimal example can be represented as follows, the top line in bold is added to indicate the field type:
\begin{align*}
\conllu{\textbf{ID}}\tab\conllu{\textbf{FORM}}\tab\conllu{\textbf{LEMMA}}\tab\conllu{\textbf{UPOS}}\tab\conllu{\textbf{XPOS}}\tab\conllu{\textbf{FEATS}}\tab\conllu{\textbf{HEAD}}\tab\conllu{\textbf{DEPREL}}\tab\conllu{\textbf{DEPS}}\tab\conllu{\textbf{MISC}}\\
\conllu{1}\tab\conllu{why}\tab\conllu{why}\tab\conllu{ADV}\tab\conllu{WRB}\tab\conllu{PronType=Int}\tab\conllu{0}\tab\conllu{root}\tab\conllu{\_}\tab\conllu{\_}\\
\conllu{2}\tab\conllu{?}\tab\conllu{?}\tab\conllu{PUNCT}\tab\conllu{.}\tab\conllu{\_}\tab\conllu{1}\tab\conllu{punct}\tab\conllu{\_}\tab\conllu{\_}
\end{align*}

\paragraph{multi-word tokens}

% subsection  (end)

\section{Shared Information vs. Exclusive Information}
% token as the basic unit of CHAT and CoNLL-U annotations.
% token also links %mor and %gra to the main line. one-to-one correspondence
% between normalised utterance and %mor.
